(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{C90p:function(e,t,o){"use strict";function s(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}o.r(t);o("yt8O"),o("RW0V"),o("rGqo"),o("KKXr");var a=o("L2JU"),r=o("B6RA"),n=o("dSBk"),c=o("Hfx9"),l={components:{closeBtn:n.a},data:function(){return{message:"Game over,",messageText:"Your score is",graduationMessage:"You can't even finish the school.",schoolScoreMessage:"Your score is",userName:"",highestScore:null,networkProblemDialog:!1,tryAgainBtnLoading:!1,offlineSaveUserMessage:"You are offline, connect to the internet to save results.",hiscoreGreeting:"Your highest score is",exclamation:"!",lastScores:"",schoolScores:"",dbUsersCollRef:"users"}},computed:function(e){for(var t=1;t<arguments.length;t++){var o=null==arguments[t]?{}:arguments[t],a=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),a.forEach(function(t){s(e,t,o[t])})}return e}({},Object(a.c)(["getTotalScore","getSchoolScore","getCurrentGameState","getDefaultUserName","getUserData"])),mounted:function(){var e=this;this.$nextTick(function(){console.log("Game over."),e.userName=e.getUserData.isAuthenticated?localStorage.getItem("userName"):e.getDefaultUserName,e.getCurrentGameState.gameInProgress?(""===localStorage.getItem("highestScore")?(console.log("No local storage score array exist yet, creating one"),e.highestScore=e.getTotalScore,localStorage.setItem("highestScore",e.getTotalScore),e.addScoreToDatabase()):(e.lastScores=localStorage.getItem("lastScoresArray"),e.schoolScores=localStorage.getItem("schoolScores"),e.highestScore=localStorage.getItem("highestScore"),e.addScoreToDatabase()),r.a.commit("stopGame")):console.log("Nothing to record, play the game.")})},methods:{restartGame:function(){console.log("Restarting game."),r.a.commit("resetState"),this.$router.push("/game")},addScoreToDatabase:function(){console.log("Adding score."),this.lastScores=""===this.lastScores?[]:this.lastScores.split(","),this.schoolScores=""===this.schoolScores?[]:this.schoolScores.split(","),this.getTotalScore>this.highestScore?(this.highestScore=this.getTotalScore,localStorage.setItem("highestScore",this.getTotalScore)):console.log("Your score is not so high: ".concat(this.getTotalScore)),this.getCurrentGameState.schoolCompleted?(this.lastScores.push(this.getTotalScore),localStorage.setItem("lastScoresArray",this.lastScores),this.schoolScores.push(this.getSchoolScore),localStorage.setItem("schoolScores",this.schoolScores)):(this.schoolScores.push(this.getSchoolScore),localStorage.setItem("schoolScores",this.schoolScores)),this.getUserData.isAuthenticated?this.getUserData.isAuthenticated&&this.isOnline?(console.log("User is authenticated and network is online. Syncing with firestore."),this.syncScoreWithFirestore()):this.getUserData.isAuthenticated&&!this.isOnline&&this.getCurrentGameState.gameInProgress?(console.log("User is authenticated but network is offline."),this.networkProblemDialog=!0):console.log("Something went wrong in the piping system."):console.log("Anonymous! To save results please register.")},syncScoreWithFirestore:function(){var e=this;this.tryAgainBtnLoading=!this.tryAgainBtnLoading,console.log("Syncing score for user ".concat(localStorage.getItem("userName")));var t=localStorage.getItem("userUid");c.a.collection(this.dbUsersCollRef).where("uid","==",t).get().then(function(e){var o;return e.forEach(function(e){e.data().uid===t&&(o=e.id)}),o}).then(function(t){var o=c.a.collection(e.dbUsersCollRef).doc(t),s=localStorage.getItem("lastScoresArray"),a=localStorage.getItem("highestScore"),r=localStorage.getItem("schoolScores"),n=o.update({resultsArray:s,schoolResultsArray:r,hiScore:a});return console.log("...updating user stats"),e.tryAgainBtnLoading=!e.tryAgainBtnLoading,e.networkProblemDialog=!e.networkProblemDialog,n}).catch(function(t){e.tryAgainBtnLoading=!e.tryAgainBtnLoading,console.log("Error getting documents: ",t)})}}},i=(o("R/k8"),o("KHd+")),g=Object(i.a)(l,function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-container",{attrs:{id:"endGame","fill-height":""}},[o("v-layout",{attrs:{column:""}},[o("closeBtn"),e._v(" "),o("v-flex",{staticClass:"user-name-game-end text-xs-center"},[o("h1",[e._v("\n        "+e._s(e.message)),o("br"),e._v(" "),o("span",[e._v(e._s(e.userName)+e._s(e.exclamation))])])]),e._v(" "),e.getCurrentGameState.schoolCompleted?e._e():o("v-flex",{staticClass:"message-school text-xs-center"},[o("h3",[e._v(e._s(e.graduationMessage))]),e._v(" "),o("h2",[e._v(e._s(e.schoolScoreMessage)+" "+e._s(e.getTotalScore))])]),e._v(" "),e.getCurrentGameState.schoolCompleted?o("v-flex",{staticClass:"message-game text-xs-center"},[o("h2",[e._v(e._s(e.messageText)+" "+e._s(e.getTotalScore))])]):e._e(),e._v(" "),o("v-layout",{attrs:{row:"","align-center":"","justify-space-around":""}},[o("v-flex",{staticClass:"text-xs-center",attrs:{"d-flex":"",xs5:"",lg2:""}},[o("v-btn",{attrs:{ripple:"",outline:"",color:"orange"},on:{click:e.restartGame}},[o("v-icon",{attrs:{medium:"",color:"orange"}},[e._v("\n            replay\n          ")]),e._v("\n          restart\n        ")],1)],1),e._v(" "),o("v-flex",{staticClass:"text-xs-center",attrs:{"d-flex":"",xs5:"",lg2:""}},[o("v-btn",{attrs:{ripple:"",outline:"",color:"purple darken-1",to:"/userstats"}},[o("v-icon",{attrs:{medium:"",color:"purple darken-1"}},[e._v("\n            trending_up\n          ")]),e._v("\n          stats\n        ")],1)],1)],1)],1),e._v(" "),o("v-dialog",{attrs:{width:"20em"},model:{value:e.networkProblemDialog,callback:function(t){e.networkProblemDialog=t},expression:"networkProblemDialog"}},[o("v-card",[o("v-card-text",{staticClass:"text-xs-center offline-save-message"},[e._v("\n        "+e._s(e.offlineSaveUserMessage)+"\n      ")]),e._v(" "),o("v-card-actions",[o("v-spacer"),e._v(" "),o("v-btn",{attrs:{color:"orange",outline:"",loading:e.tryAgainBtnLoading},on:{click:e.syncScoreWithFirestore}},[o("v-icon",{attrs:{color:"orange"}},[e._v("\n            done\n          ")]),e._v("\n          Try again\n        ")],1),e._v(" "),o("v-btn",{attrs:{outline:"",ripple:"",color:"purple darken-1"},on:{click:function(){e.networkProblemDialog=!1}}},[o("v-icon",{attrs:{color:"purple darken-1"}},[e._v("\n            cancel\n          ")]),e._v("\n          Cancel\n        ")],1),e._v(" "),o("v-spacer")],1)],1)],1)],1)},[],!1,null,"009e48b3",null);t.default=g.exports},GKqa:function(e,t,o){(e.exports=o("I1BE")(!1)).push([e.i,'/* latin */\n@font-face {\n  font-family: \'Quicksand\';\n  font-style: normal;\n  font-weight: 400;\n  font-display: swap;\n  src: local("Quicksand Regular"), local("Quicksand-Regular"), url(https://fonts.gstatic.com/s/quicksand/v8/6xKtdSZaM9iE8KbpRA_hK1QN.woff2) format("woff2");\n  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;\n}\n\n/* cyrillic */\n@font-face {\n  font-family: \'Montserrat\';\n  font-style: normal;\n  font-weight: 400;\n  font-display: swap;\n  src: local("Montserrat Regular"), local("Montserrat-Regular"), url(https://fonts.gstatic.com/s/montserrat/v12/JTUSjIg1_i6t8kCHKm459W1hyzbi.woff2) format("woff2");\n  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;\n}\n.default use[data-v-009e48b3] {\n  color: #7B1FA2;\n  stroke: #7B1FA2;\n}\n.chosen use[data-v-009e48b3] {\n  color: #FF9800;\n  stroke: #FF9800;\n}\n.user-name-game-end[data-v-009e48b3], .message-school[data-v-009e48b3], .message-game[data-v-009e48b3], .offline-save-message[data-v-009e48b3] {\n  font-family: "Quicksand", "Verdana", sans-serif;\n}\n.user-name-game-end span[data-v-009e48b3] {\n  color: #FF9800;\n}\n.message-school[data-v-009e48b3] {\n  line-height: 1.5;\n}\n',""])},"R/k8":function(e,t,o){"use strict";var s=o("tu3Q");o.n(s).a},tu3Q:function(e,t,o){var s=o("GKqa");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals),o("SZ7m")("5787ffcc",s,!0,{})}}]);