webpackJsonp([4],{o8LO:function(e,t){},xJsL:function(e,t,s){"use strict";function n(e){s("o8LO")}Object.defineProperty(t,"__esModule",{value:!0});var r=s("Dd8w"),o=s.n(r),a=s("NYxO"),i=s("qVsQ"),l=s("yviF"),u=s.n(l),c=(s("dih4"),s("wtEF")),g=s("stGB"),d=this,m={name:"login",data:function(){return{loader:null,logginIn:!1,loggingOut:!1,users:[],errorMessage:void 0,newUserBtnText:"Create new user",pageTitle:"Log In",valid:!0,name:"",nameRules:[function(e){return!!e||"Name is required"},function(e){return e&&e.length<=10||"Name must be less than 10 characters"}],email:"",emailRules:[function(e){return!!e||"E-mail is required"},function(e){return/.+@.+/.test(e)||"E-mail must be valid"}],password:"",passwordRules:[function(e){return!!e||"Password is required"},function(e){return e&&e.length<=12||"Password must be less than 12 characters"}],confirmPassword:"",select:null,items:["Item 1","Item 2","Item 3","Item 4"],checkbox:!1}},components:{closeBtn:g.a},computed:o()({},Object(a.c)(["getError","getUserAuthState","getUserName"]),{comparePasswords:function(){return this.password===this.confirmPassword||"Passwords do not match"}}),methods:{setLoginLoadingState:function(){return this.logginIn=!this.logginIn,!0},getUserNameFromDB:function(e){i.a.collection("users").where("uid","==",e).get().then(function(t){var s=void 0;return t.forEach(function(t){t.data().uid===e&&(s=t.data().name)}),c.a.commit("setUserName",s),console.log("Setting user name: "+s),s}).catch(function(e){console.log("Error getting documents: ",e)})},login:function(){var e=this;if(this.errorMessage=void 0,this.email&&this.password)return this.setLoginLoadingState(),u.a.auth().signInWithEmailAndPassword(this.email,this.password).then(function(t){console.log("You are logged in as"),console.log(t.user.email),console.log(t.user.uid);var s=e.getUserNameFromDB(t.user.uid),n={isAuthenticated:!0,uid:t.user.uid,name:s};e.$store.commit("setUser",n),e.$router.push("/")},function(t){console.log(t.message),e.errorMessage=t.message,e.setLoginLoadingState()}),!0},signOut:function(){d.loggingOut=!d.loggingOut,u.a.auth().signOut().then(function(){console.log("Signed Out"),localStorage.removeItem("highestScore"),localStorage.removeItem("lastScoresArray"),localStorage.removeItem("schoolScores"),c.a.commit("setAuthState",!1)},function(e){console.error("Sign Out Error",e),this.loggingOut=!this.loggingOut})},clear:function(){this.$refs.form.reset()}},mounted:function(){console.log("Login page mounted")}},f=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("v-container",{attrs:{fluid:"",id:"login"}},[s("closeBtn"),e._v(" "),s("v-layout",{attrs:{column:""}},[s("v-flex",{attrs:{"d-flex":""}},[s("v-alert",{attrs:{value:e.errorMessage,dismissible:"",outline:"",type:"error"}},[e._v("\n          "+e._s(e.errorMessage)+"\n        ")])],1),e._v(" "),s("v-flex",{staticClass:"page-title text-xs-center py-4",attrs:{"d-flex":""}},[s("h1",[e._v(e._s(e.pageTitle))])]),e._v(" "),s("v-layout",{staticClass:"login-form py-4",attrs:{"justify-center":""}},[s("v-flex",{attrs:{xs8:"","d-flex":"","align-center":"","py-4":""}},[s("v-form",{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[s("v-text-field",{attrs:{rules:e.emailRules,label:"E-mail",type:"email",autocomplete:"off",required:"",color:"purple accent-4"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}}),e._v(" "),s("v-text-field",{attrs:{rules:e.passwordRules,type:"password",label:"Password",autocomplete:"off",required:"",color:"purple accent-4"},model:{value:e.password,callback:function(t){e.password=t},expression:"password"}})],1)],1)],1),e._v(" "),s("v-layout",{staticClass:"text-xs-center",attrs:{"justify-center":""}},[s("v-flex",{attrs:{xs5:"","d-flex":"","align-end":""}},[s("v-btn",{staticClass:"button white--text",attrs:{disabled:!e.valid,type:"submit",loading:e.logginIn,large:"",color:"orange"},on:{click:function(t){return t.preventDefault(),e.login(t)}}},[e._v("\n            login\n          ")])],1),e._v(" "),s("v-flex",{attrs:{xs5:"","d-flex":"","align-end":""}},[s("v-btn",{staticClass:"button",attrs:{dark:"",large:"",color:"purple darken-1"},on:{click:e.clear}},[e._v("\n          clear")])],1)],1),e._v(" "),s("v-layout",{staticClass:"text-xs-center",attrs:{wrap:""}},[s("v-flex",{staticClass:"info-text",attrs:{"d-flex":"","align-center":""}},[s("span",[e._v("or")])]),e._v(" "),s("v-flex",{attrs:{xs12:""}},[s("v-btn",{staticClass:"button",attrs:{to:"/register",dark:"",large:"",color:"purple darken-1"}},[e._v("\n            "+e._s(e.newUserBtnText)+"\n          ")]),e._v(" "),s("v-btn",{staticClass:"button white--text",attrs:{loading:e.loggingOut,disabled:!this.getUserAuthState,large:"",color:"purple darken-1"},on:{click:e.signOut}},[e._v("\n          sign out")])],1)],1)],1)],1)},v=[],h={render:f,staticRenderFns:v},p=h,x=s("VU/8"),w=n,b=x(m,p,!1,w,"data-v-43017860",null);t.default=b.exports}});
//# sourceMappingURL=4.9091095cf1a94373a1c0.js.map